---
title: "Board Games"
subtitle: "There are more of them than you'd think!"
author: "Gamesonyourphone? <br> Grace Acton, Finn Conway, and Jackson Donahue"
institute: "Bates College"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
```{r import-board-games, include=FALSE, echo=FALSE}
board_games <- readr::read_csv("/cloud/project/data/board_games.csv")
```

```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
install.packages("readxl")
library(readxl)
source("/cloud/project/extra/HeatMap_Prep.R")
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r importing-class-data, include=FALSE}
library(readxl)
read_excel("/cloud/project/extra/Gamesonyourphone?.xlsx")
```

```{r style, echo=FALSE}
style_solarized_dark()
```

---
class: center, top

## Goals and Questions

- How does playing time impact the popularity of board games?

--

- What categories do games fit into, and how do they overlap?

--

- How do game mechanics influence how games are perceived?

--

- How does our class data align with the broader board game dataset?

---
class: inverse, center, middle

# Our Data

---
class: top, center

## Where did we find this?

--
```{r tidytuesday-image, echo=FALSE, out.width ='60%', fig.align = 'center'}
include_graphics("https://github.com/rfordatascience/tidytuesday/raw/master/static/tt_logo.png")
```

---
class: top, center

## What's in this set?

--
```{r glimpse-set, echo=FALSE}
glimpse(board_games)
```
---
class: top, center

## What's in this set?

--
### A lot.

--
.pull-left[

- Name
- Description
- Image
- Designer
- Family
- Publisher
- Game mechanic
- Category
]

--
.pull-right[
- Minimum/maximum playtime
- Minimum age
- Minimum/maximum players
- Year published
- Number of ratings
- **Average rating**
]

---
class: inverse, center, middle

# Playing Time

---
class: top, center, middle

## How long do games take?
```{r def-standard-theme, echo=FALSE, include=FALSE}
theme_standard <- theme(title = element_text(size = 15),
        axis.title = element_blank(),
        axis.text = element_text(size = 10),
        legend.title = element_text(size = 12),
        legend.text = element_text(size = 10))
```

```{r, echo=F, include= F}
board_games %>%
  arrange(desc(max_playtime))

board_games <- board_games %>%
  mutate(
    playtime_group = case_when(
      playing_time < 1 ~ "N/A",
      playing_time >= 1 & playing_time <= 20 ~ "Under 20 minutes",
      playing_time >= 21 & playing_time <= 40 ~ "20-40 minutes",
      playing_time >= 41 & playing_time <= 60 ~ "40-60 minutes",
      playing_time >= 61 & playing_time <= 120 ~ "1-2 hours",
      playing_time >= 121 & playing_time <= 180 ~ "2-3 hours",
      playing_time >= 181 & playing_time <= 240 ~ "3-4 hours",
      playing_time >= 241 & playing_time <= 360 ~ "4-6 hours",
      playing_time >= 361 ~ "Over 6 hours"
    ))
``` 
.center[
```{r bar-plot, warning = FALSE, echo = FALSE, message = FALSE, fig.alt= "In this graph, we have a histogram displaying the frequency of games in each group of playing times. It reveals that most games are under an hour, with a fairly even split between the groups of 0-20 minutes and 20-40. The 40-60 group has the most number of games. Beyond that, there are a few spikes around convenient time labels such as 2 hours, 3 hours etc, but the vast majority of games lie in this under an hour range.", out.width = "70%", out.height = "70%", fig.align='center' }
barchart <- board_games %>%
  filter(playing_time <= 400)

fig1 <-ggplot(data = barchart, aes(playing_time, fill= factor(playtime_group, 
                                                          c("Under 20 minutes",
                                                            "20-40 minutes",
                                                            "40-60 minutes",
                                                            "1-2 hours",
                                                            "2-3 hours",
                                                            "3-4 hours",
                                                            "4-6 hours",
                                                            "over 6 hours",
                                                            "NA")))) +
    geom_histogram() +
    xlim(0,500) +
    labs(title = "Playtime density",
       x = "Playing time (minutes)",
       y = "Count",
       fill = "Length of Play") +
    scale_fill_viridis_d() + 
    theme_void() +
    theme_standard +
    theme_xaringan()
  
ggplotly(fig1)
```
]
---
class: top, center, middle

## Rating of Games by Playtime

```{r violin-plot, echo = F, warning = F, message = F, fig.alt = "", out.width = "70%", out.height= "70%", fig.align='center'}
board_games %>% 
  
ggplot(aes(x = playtime_group , y = average_rating, fill= factor(playtime_group, 
                                                          c("Under 20 minutes",
                                                            "20-40 minutes",
                                                            "40-60 minutes",
                                                            "1-2 hours",
                                                            "2-3 hours",
                                                            "3-4 hours",
                                                            "4-6 hours")))) +
  labs(fill = "Playtime Group",
       x = "Length of Play",
       y = "Game Rating") +
  theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
  geom_violin()  + 
  scale_x_discrete(limits = c("Under 20 minutes",
                                                            "20-40 minutes",
                                                            "40-60 minutes",
                                                            "1-2 hours",
                                                            "2-3 hours",
                                                            "3-4 hours",
                                                            "4-6 hours"))+ 
  scale_fill_viridis_d() +
  theme_xaringan() +
  theme_standard
```
---
class: top, center, middle

## Number of Ratings vs Rating of Game
### By Year Published
```{r best-boardgame, echo = F, warning = F, message = F, fig.alt = "", out.width = "80%", out.height= "70%", fig.align = 'center'}

colors <- c("#ffffb2", "#fed976", "#feb24c", "#fd8d3c", "#f03b20", "#bd0026")

best_boardgame <- board_games %>%
  filter(users_rated >= 50) %>%
  select(name, average_rating, users_rated, category, year_published, playing_time)

pointfig <- ggplot(data = best_boardgame, mapping = aes(x = average_rating, y = users_rated)) +
  
  geom_point(data = best_boardgame, mapping = aes(color = (year_published)), alpha = 0.5) +
  labs(x = "Average rating",
       y = "Amount of user ratings", 
       color = "Year published") + 
  theme_void() +
  theme_xaringan() +
  theme_standard +
  scale_color_stepsn(colors = colors)

ggplotly(pointfig)
```
---
class: inverse, center, middle

# Categories

---
class: top, center

## What categories are used?
```{r categories, echo=FALSE, include=FALSE}
categories <- board_games %>% 
  select(category) %>% 
  separate(category, into = c("category1", "category2", "category3", "category4"), sep = ",")
```
--
.pull-left[

### Primary Categories

```{r top-categories1, echo=FALSE}
categories %>% 
  group_by(category1) %>% 
  count() %>% 
  arrange(desc(n))
```
]

--
.pull-right[

### Secondary Categories

```{r top-categories2, echo=FALSE}
categories %>% 
  group_by(category2) %>% 
  count() %>% 
  arrange(desc(n))
```
]

---
class: top, center

## How do they overlap?

```{r heatmap, echo=FALSE, warning=FALSE, fig.align = 'center', out.width='80%', fig.alt="Heatmap of overlapping game categories, which shows that the most common two-category game descriptions are Fantasy Card Games and Bluffing Card Games."}
colors <- c("#ffffb2", "#fed976", "#feb24c", "#fd8d3c", "#f03b20", "#bd0026")

map_counts %>% 
  ggplot(aes(x = category2, y = category1, fill = n)) +
  geom_tile() +
  labs(title = "Heatmap of Category Overlaps",
       x = "Category 2",
       y = "Category 1",
       fill = "Number of Overlaps") +
  theme_xaringan() +
  theme_standard +
  theme(axis.text.x = element_text(angle = 90)) +
  scale_fill_stepsn(colors = colors)
```

---
class: inverse, center, middle

# Game Mechanics

---
class: top, center

# FINN'S SLIDE

---
class: top, center

# FINN'S SLIDE

---
class: top, center

# FINN'S SLIDE

---
class: inverse, center, middle

# Class Data

---
class: top, center

# What do we think about board games?

---
class: top, center

## More about the class dataset